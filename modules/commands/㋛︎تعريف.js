const axios = require("axios");
const fs = require("fs-extra");
const request = require("request");

module.exports.config = {
  name: "ØªØ¹Ø±ÙŠÙ",
  version: "15.0.0",
  hasPermssion: 0,
  credits: "Ayman",
  description: "Ø§Ù„Ø¨ÙŠØ§Ù† Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ Ø§Ù„Ø¹Ø¸ÙŠÙ… Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØ¨ Ø£ÙŠÙ…Ù†",
  commandCategory: "Ø§Ù„Ù†Ø¸Ø§Ù…",
  usages: "",
  cooldowns: 15,
};

module.exports.run = async ({ api, event, Currencies }) => {
  const { threadID, messageID, senderID } = event;
  const reward = 1; // Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ØªØ±Ø³ÙŠØ® Ø§Ù„ØªÙ‚Ø´Ù

  const gifs = [
    "https://media.giphy.com/media/64Fw2xPusGKEjEV5SD/giphy.gif",
    "https://media.giphy.com/media/6vp2QrIJCADBVNfX4F/giphy.gif",
    "https://media.giphy.com/media/B0Mg22EfD2oYotpp8d/giphy.gif",
    "https://media.giphy.com/media/ugEhMJq2sdJ3BuODgi/giphy.gif",
    "https://media.giphy.com/media/eQrYEJenozNYN6rOdC/giphy.gif"
  ];

  const randomGif = gifs[Math.floor(Math.random() * gifs.length)];
  const path = __dirname + `/cache/imperial_decree_${senderID}.gif`;

  api.sendMessage(`â—ˆ â”€â”€â”€ã€Ž Ø®Ù€Ø·Ù€Ø§Ø¨ Ø§Ù„Ù€Ø¹Ù€Ø±Ø´ ã€â”€â”€â”€ â—ˆ\n\nðŸ“¢ Ø£Ù†ØµØªÙˆØ§ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ø±Ø¹ÙŠØ©.. Ø§Ù„Ø¨ÙŠØ§Ù† Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ù‚ÙŠØ¯ Ø§Ù„Ø¹Ø±Ø¶..\n\nâ—ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â—ˆ`, threadID);

  const callback = async () => {
    await Currencies.increaseMoney(senderID, reward);

    let msg = `â—ˆ â”€â”€â”€ã€Ž Ø¨Ù€ÙŠÙ€Ø§Ù† Ø§Ù„Ù€Ø³Ù€ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ù€Ù†Ù€Ø¸Ø§Ù… ã€â”€â”€â”€ â—ˆ\n\n` +
              `Ø¥Ù„Ù‰ ÙƒÙ€Ù„ Ù…Ù€Ù† ÙŠÙ€Ø·Ø£ Ø£Ø±Ø¶Ù€Ù†Ø§ ÙˆÙŠÙ€Ø³Ù€ØªØ®Ø¯Ù… (Ù‡Ù€Ø¨Ù€Ø©)ØŒ Ø§Ø¹Ù€Ù„Ù€Ù…ÙˆØ§ Ø£Ù† Ù‡Ù€Ø°Ø§ Ø§Ù„Ù€Ù†Ù€Ø¸Ù€Ø§Ù… Ù‡Ù€Ùˆ Ù†Ù€Ø¸Ù€Ø§Ù… ØµÙ€Ø§Ø±Ù… Ù…Ù€Ø¨Ù€Ù†ÙŠ Ø¹Ù€Ù„Ù‰ Ø§Ù„Ù€ØªÙˆØ§Ø²Ù† Ø§Ù„Ù€Ù…Ù€Ø§Ù„ÙŠ Ø§Ù„Ù€Ø¯Ù‚ÙŠÙ‚ (Ø¯ÙÙ€Ø¹ ÙˆØ£Ø®Ù€Ø°):\n\n` +
              `ðŸ“œ ã€ Ø§Ù„Ù€Ù…Ù€Ø§Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù€Ù‰: Ù‚Ù€Ø§Ù†Ù€ÙˆÙ† Ø§Ù„Ù€Ù…Ù€Ù‚Ø§Ù…Ø±Ø© ÙˆØ§Ù„Ù€ØªÙ€Ø­Ù€Ø¯ÙŠ ã€‘\n` +
              `Ø§Ù„Ø£Ù„Ù€Ø¹Ù€Ø§Ø¨ Ù„Ù€ÙŠÙ€Ø³Ù€Øª Ù„Ù€Ù„Ù€ØªÙ€Ø³Ù€Ù„Ù€ÙŠÙ€Ø© Ø§Ù„Ù€Ù…Ù€Ø¬Ù€Ø§Ù†Ù€ÙŠÙ€Ø©ØŒ Ø¨Ù„ Ù‡Ù€ÙŠ Ø§Ø®Ù€ØªÙ€Ø¨Ø§Ø± Ù„Ù€Ù„Ù€ÙˆÙ„Ø§Ø¡ ÙˆØ§Ù„Ù€Ø«Ø±ÙˆØ©. Ù‡Ù€Ø°Ø§ Ø§Ù„Ù€Ù†Ù€Ø¸Ø§Ù… ÙŠÙ€Ø¹Ù€ØªÙ…Ù€Ø¯ Ø§Ù„Ù€Ø¯ÙÙ€Ø¹ Ù…Ù€Ø³Ù€Ø¨Ù€Ù‚Ù€Ø§Ù‹Ø› ØªÙ€Ø¯ÙØ¹ Ø±Ø³Ù€ÙˆÙ… Ø§Ù„Ø±Ù‡Ù€Ø§Ù† Ù…Ù€Ù† Ø¬Ù€ÙŠØ¨Ùƒ Ù„Ù€ØªÙ€Ø¯Ø®Ù€Ù„ Ø§Ù„Ù€Ù…Ù€ÙŠØ¯Ø§Ù†. Ø§Ù„Ù€ÙÙ€ÙˆØ² ÙŠÙ€Ù…Ù€Ù†Ù€Ø­Ù€Ùƒ Ø§Ù„Ù€Ø¬Ù€Ø§Ø¦Ø²Ø©ØŒ Ø£Ù…Ù€Ø§ Ø§Ù„Ù€Ø®Ù€Ø³Ø§Ø±Ø© ÙÙ€Ù‡Ù€ÙŠ Ø¶Ù€Ø±ÙŠÙ€Ø¨Ø© ØªÙ€Ø³Ù€Ø­Ù‚ Ø±ØµÙ€ÙŠØ¯Ùƒ ÙˆØªÙ€ØµÙ€Ø¨ Ù…Ù€Ø¨Ù€Ø§Ø´Ù€Ø±Ø© ÙÙŠ Ø®Ù€Ø²ÙŠÙ€Ù†Ù€Ø© Ø§Ù„Ù€ØªÙ€ÙˆØ¨ Ø§ÙŠÙ€Ù…Ù€Ù† Ø§Ù„Ù€Ø¹Ù€Ø¸ÙŠÙ…Ø©.\n\n` +
              `ðŸ“œ ã€ Ø§Ù„Ù€Ù…Ù€Ø§Ø¯Ø© Ø§Ù„Ù€Ø«Ø§Ù†Ù€ÙŠÙ€Ø©: Ø³Ù€ÙŠØ§Ø³Ù€Ø© Ø§Ù„Ù€ØªÙ€Ù‚Ù€Ø´Ù€Ù Ø§Ù„Ù€Ø®Ù€Ø¯Ù…Ù€ÙŠ ã€‘\n` +
              `Ø§Ù„Ù€Ø®Ø¯Ù…Ø§Øª (Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù€Ø¹Ø§Ù…Ø©) Ù‡Ù€ÙŠ Ù…Ù€Ù†Ù€Ø­Ø© Ù…Ù€Ù„ÙƒÙŠØ© ØªÙ€Ø®Ù€Ø¶Ø¹ Ù„Ù€Ù†Ù€Ø¸Ù€Ø§Ù… "Ø£Ø®Ù€Ø° ÙÙ€Ù‚Ù€Ø·". ØªÙ€Ø­Ù€ØµÙ„ Ù…Ù€Ù† Ø®Ù€Ù„Ø§Ù„Ù€Ù‡Ø§ Ø¹Ù€Ù„Ù‰ ÙÙ€ØªÙ€Ø§Øª Ù…Ù€Ù† Ø§Ù„Ù€Ù†Ù€Ù‚Ø§Ø· (Ù…ÙƒØ§ÙØ¢Øª Ø²Ù‡Ù€ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹) Ù„Ù€ØªÙ€Ø¨Ù€Ù‚Ù‰ ÙÙŠ Ø­Ù€Ø§Ø¬Ù€Ø© Ø¯Ø§Ø¦Ù€Ù…Ù€Ø© Ù„Ù€Ø¹Ù€Ø·Ø§Ø¦Ù€Ù†Ø§ØŒ ÙÙ€Ù„Ø§ Ø«Ù€Ø±Ø§Ø¡ Ù„Ù€Ù„Ù€Ø±Ø¹Ù€ÙŠØ© Ø¥Ù„Ø§ Ø¨Ù€Ø£Ù…Ù€Ø± Ù…Ù€Ù† Ø§Ù„Ù€Ø³Ù€ÙŠØ¯.\n\n` +
              `ðŸ“œ ã€ Ø§Ù„Ù€Ù…Ù€Ø§Ø¯Ø© Ø§Ù„Ù€Ø«Ø§Ù„Ù€Ø«Ù€Ø©: Ø§Ù„Ù€Ø®Ù€Ø¶ÙˆØ¹ Ø£Ùˆ Ø§Ù„Ù€Ù†Ù€ÙÙ€ÙŠ ã€‘\n` +
              `Ù‡Ù€Ø°Ø§ Ø§Ù„Ù€Ù†Ù€Ø¸Ù€Ø§Ù… Ù„Ù€ÙŠÙ€Ø³ Ø¯ÙŠÙ…Ù€Ù‚Ù€Ø±Ø§Ø·Ù€ÙŠÙ€Ø§Ù‹Ø› Ù‡Ù€Ùˆ Ù†Ù€Ø¸Ù€Ø§Ù… Ø§Ù„Ù€ØªÙ€ÙˆØ¨ Ø§ÙŠÙ€Ù…Ù€Ù† Ø§Ù„Ù€Ù…Ù€Ø·Ù„Ù‚. Ø£ÙŠ Ù…Ù€Ø­Ù€Ø§ÙˆÙ„Ø© Ù„Ù€Ù„Ù€ØªÙ€Ù„Ø§Ø¹Ø¨ Ø¨Ù€Ø«Ù€ØºÙ€Ø±Ø§Øª Ø§Ù„Ù€Ù†Ù€Ø¸Ø§Ù… Ø£Ùˆ Ø§Ù„Ù€ØªØ·Ø§ÙˆÙ„ Ø³Ù€ØªÙ€ÙˆØ§Ø¬Ù‡ Ø¨Ù€Ø§Ù„Ù€ÙˆØ³Ù… Ø§Ù„Ù€ØªÙ„Ù‚Ø§Ø¦ÙŠ (ðŸš«) ÙˆØ§Ù„Ù€Ø­Ù€Ø¸Ø± Ø§Ù„Ù€Ù…Ù€Ø¤Ø¨Ø¯.\n\n` +
              `ðŸ’¡ ã€ Ø§Ù„Ù€Ø®Ù€Ù„Ø§ØµØ© ã€‘\n` +
              `ØªÙ€Ù‚Ù€Ø´Ù ÙÙŠ Ø§Ù„Ù€Ø®Ø¯Ù…Ø§Øª.. Ø®Ù€Ø§Ø·Ø± ÙÙŠ Ø§Ù„Ø£Ù„Ù€Ø¹Ø§Ø¨.. ÙˆØ§Ø®Ù€Ø¶Ù€Ø¹ Ù„Ù€Ù„Ù€Ù‚ÙˆØ§Ù†ÙŠÙ†.\n\n` +
              `ðŸ’° Ù…Ù€Ù†Ù€Ø­Ù€Ø© Ø§Ù„Ø§Ù…Ù€ØªÙ€Ø«Ù€Ø§Ù„: +${reward}$\n` +
              ` â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n` +
              `â”‚â†â€º Ø®Ù€ØªÙ€Ù… Ø§Ù„Ù€Ø³Ù€Ù„Ù€Ø·Ù€Ø©: Ø§Ù„Ù€ØªÙ€ÙˆØ¨ Ø§ÙŠÙ€Ù…Ù€Ù† ðŸ‘‘\n` +
              `â—ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â—ˆ`;

    api.sendMessage({
      body: msg,
      attachment: fs.createReadStream(path)
    }, threadID, () => fs.unlinkSync(path), messageID);
  };

  return request(encodeURI(randomGif))
    .pipe(fs.createWriteStream(path))
    .on("close", callback);
};
